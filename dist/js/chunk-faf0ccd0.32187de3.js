(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-faf0ccd0"],{"04d1":function(t,e,n){var o=n("342f"),i=o.match(/firefox\/(\d+)/i);t.exports=!!i&&+i[1]},2532:function(t,e,n){"use strict";var o=n("23e7"),i=n("5a34"),r=n("1d80"),a=n("577e"),s=n("ab13");o({target:"String",proto:!0,forced:!s("includes")},{includes:function(t){return!!~a(r(this)).indexOf(a(i(t)),arguments.length>1?arguments[1]:void 0)}})},"44e7":function(t,e,n){var o=n("861d"),i=n("c6b6"),r=n("b622"),a=r("match");t.exports=function(t){var e;return o(t)&&(void 0!==(e=t[a])?!!e:"RegExp"==i(t))}},"4e82":function(t,e,n){"use strict";var o=n("23e7"),i=n("1c0b"),r=n("7b0b"),a=n("50c4"),s=n("577e"),c=n("d039"),l=n("addb"),d=n("a640"),u=n("04d1"),f=n("d998"),h=n("2d00"),p=n("512ce"),v=[],g=v.sort,k=c((function(){v.sort(void 0)})),m=c((function(){v.sort(null)})),x=d("sort"),w=!c((function(){if(h)return h<70;if(!(u&&u>3)){if(f)return!0;if(p)return p<603;var t,e,n,o,i="";for(t=65;t<76;t++){switch(e=String.fromCharCode(t),t){case 66:case 69:case 70:case 72:n=3;break;case 68:case 71:n=4;break;default:n=2}for(o=0;o<47;o++)v.push({k:e+o,v:n})}for(v.sort((function(t,e){return e.v-t.v})),o=0;o<v.length;o++)e=v[o].k.charAt(0),i.charAt(i.length-1)!==e&&(i+=e);return"DGBEFHACIJK"!==i}})),y=k||!m||!x||!w,I=function(t){return function(e,n){return void 0===n?-1:void 0===e?1:void 0!==t?+t(e,n)||0:s(e)>s(n)?1:-1}};o({target:"Array",proto:!0,forced:y},{sort:function(t){void 0!==t&&i(t);var e=r(this);if(w)return void 0===t?g.call(e):g.call(e,t);var n,o,s=[],c=a(e.length);for(o=0;o<c;o++)o in e&&s.push(e[o]);s=l(s,I(t)),n=s.length,o=0;while(o<n)e[o]=s[o++];while(o<c)delete e[o++];return e}})},"512ce":function(t,e,n){var o=n("342f"),i=o.match(/AppleWebKit\/(\d+)\./);t.exports=!!i&&+i[1]},"5a34":function(t,e,n){var o=n("44e7");t.exports=function(t){if(o(t))throw TypeError("The method doesn't accept regular expressions");return t}},"787e":function(t,e,n){"use strict";var o=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticStyle:{width:"250px"}},[n("div",{staticClass:"titleBox"},[n("span",{staticClass:"title"},[t._v("已选方案")]),n("span",{staticClass:"stats"},[t._v("已选作品数目："+t._s(t.voteInfo.length)),n("br"),t._v("待选作品数目："+t._s(t.contestConfig.maxVotesNum-t.voteInfo.length))])]),n("div",{staticClass:"selectedBox"},[t._l(t.voteInfo,(function(e,o){return[null!==e?[n("div",{key:o,staticClass:"selectedWorkBox"},[n("div",{staticStyle:{width:"148.5px",height:"210px"}},[n("el-image",{attrs:{src:e.imgList[0],lazy:""},on:{click:function(n){return n.stopPropagation(),t.jumpToDetailHandler(e)}}})],1),n("div",{staticStyle:{"margin-top":"5px",display:"flex","flex-direction":"column","justify-content":"center","align-items":"center"}},[n("span",{staticClass:"tipText"},[t._v(t._s(e.workIdx)+" - "+t._s(e.name))])])])]:t._e()]}))],2),n("div",{staticStyle:{display:"flex","justify-content":"space-between","align-items":"center"}},[n("el-button",{staticStyle:{width:"48%"},attrs:{type:"primary",icon:"el-icon-collection-tag",disabled:t.userInfo.isDone},on:{click:t.saveTemp}},[t._v("保存进度")]),n("el-button",{staticStyle:{width:"48%"},attrs:{type:"success",icon:"el-icon-collection-tag",disabled:t.userInfo.isDone},on:{click:t.submitVote}},[t._v("提交结果")])],1)])},i=[],r=n("5530"),a=(n("a15b"),n("2f62")),s=n("f8c8"),c={name:"Selected",data:function(){return{intervalIdx:0}},computed:Object(r["a"])({},Object(a["b"])(["userInfo","voteInfo","contestConfig","votedWorks"])),beforeDestroy:function(){this.saveTemp(),clearInterval(this.intervalIdx)},mounted:function(){var t=this;this.intervalIdx=setInterval((function(){t.userInfo.isDone||t.saveTemp()}),3e5)},methods:Object(r["a"])(Object(r["a"])({},Object(a["c"])(["updateVoteInfo","updateUserInfo"])),{},{jumpToDetailHandler:function(t){this.$router.push({path:"/detail/"+t.workID})},saveTemp:function(){var t=this,e={round_id:this.contestConfig.roundID,voted_works:this.votedWorks.join(","),round_idx:this.contestConfig.roundIdx};this.userInfo.isDone||Object(s["j"])(e).then((function(){t.$message({type:"success",message:"保存成功！"})})).catch((function(){t.$message({type:"error",message:"保存失败！"})}))},submitVote:function(){var t=this;this.$confirm("提交结果后不可再次修改，确认提交吗？","",{confirmButtonText:"提交",cancelButtonText:"取消",type:"warning"}).then((function(){var e={round_id:t.contestConfig.roundID,voted_works:t.votedWorks.join(","),round_idx:t.contestConfig.roundIdx};Object(s["l"])(e).then((function(){t.$message({type:"success",message:"保存成功！"});var e=t.userInfo;e.isDone=!0,t.updateUserInfo(e)})).catch((function(){t.$message({type:"error",message:"保存失败！"})}))}))}})},l=c,d=(n("8d3d"),n("2877")),u=Object(d["a"])(l,o,i,!1,null,"29eef43a",null);e["a"]=u.exports},"7c71":function(t,e,n){"use strict";n("c62a")},"8d3d":function(t,e,n){"use strict";n("f7e3")},"9ecc":function(t,e,n){"use strict";n.r(e);var o=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("el-container",{staticStyle:{"margin-top":"16px",height:"calc(100vh - 120px)"}},[n("el-main",{staticStyle:{height:"100%",width:"100%",padding:"0",display:"flex","justify-content":"center"}},[n("DetailComp")],1),n("el-aside",{staticStyle:{height:"100%",display:"flex","justify-content":"center"}},[n("Selected")],1)],1)],1)},i=[],r=n("787e"),a=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticStyle:{width:"96%"}},[n("div",{staticClass:"titleBox"},[n("div",{staticStyle:{display:"flex","align-items":"center"}},[n("span",{staticClass:"title"},[t._v(" 作品详情 ")]),n("el-button",{staticStyle:{"margin-left":"20px"},attrs:{size:"mini"},on:{click:t.returnToOverview}},[t._v("返回")])],1),n("div",[n("el-tabs",{attrs:{"tab-position":"bottom"},model:{value:t.activeName,callback:function(e){t.activeName=e},expression:"activeName"}},[n("el-tab-pane",{attrs:{label:"作品编号："+t.workInfo.workIdx,name:"first"}})],1)],1)]),n("div",{staticClass:"workContainer",attrs:{id:"workContainer"}},[n("div",{staticStyle:{"text-align":"center","font-family":"Noto Sans SC","font-style":"normal","font-weight":"500","font-size":"16px","line-height":"24px","font-feature-settings":"'tnum' on, 'lnum' on",color:"#4D4F53"}},[t._v(t._s(t.workInfo.name))]),n("div",{staticClass:"imgContainer"},[t._l(t.workInfo.imgList,(function(e,o){return[n("div",{key:o,staticClass:"workBox"},[n("el-image",{staticStyle:{width:"297px",height:"420px"},attrs:{src:e,"preview-src-list":t.workInfo.imgList,alt:"点击查看原图"}}),n("span",{staticClass:"tipText"},[t._v("点击图片查看原图，使用鼠标滚轮放大缩小")])],1)]}))],2),n("div",{staticStyle:{display:"flex","justify-content":"center"}},[n("div",{class:t.workInfo.checked?"checked":"",staticStyle:{height:"40px",padding:"0 10px",border:"1px solid #E4E7ED","border-radius":"4px",display:"flex","align-items":"center"}},[n("el-checkbox",{on:{change:t.checkChangeHandler},model:{value:t.workInfo.checked,callback:function(e){t.$set(t.workInfo,"checked",e)},expression:"workInfo.checked"}},[t._v("将此作品添加为优秀待选作品")])],1)])]),n("div",{staticStyle:{display:"flex","justify-content":"space-between"}},[n("el-pagination",{attrs:{layout:"slot"}},[n("span",[t._v("共 "+t._s(t.contestConfig.totalWorkNum)+" 个作品")])]),n("el-pagination",{attrs:{layout:"slot"}},[n("span",[t._v("前往第 "),n("el-input",{staticStyle:{width:"60px"},on:{blur:t.toTargetWork},model:{value:t.targetWorkIdx,callback:function(e){t.targetWorkIdx=e},expression:"targetWorkIdx"}}),t._v(" 个")],1)])],1),n("div",{staticStyle:{display:"flex","justify-content":"space-between","margin-top":"20px"}},[n("el-button",{attrs:{icon:"el-icon-arrow-left",type:"primary"},on:{click:t.prevHandler}},[t._v("上一个")]),t.contestConfig.enableMarking?[n("el-button",{attrs:{icon:"el-icon-check",type:"primary"}},[t._v("打分")]),n("el-input",{staticStyle:{width:"80px"},attrs:{placeholder:"总分栏"}}),n("el-select",{attrs:{placeholder:"方案设计"},model:{value:t.design,callback:function(e){t.design=e},expression:"design"}},t._l(t.grades,(function(e,o){return n("el-option",{key:o,attrs:{label:"方案设计 | "+e.grade+"分",value:e.grade}},[n("span",[t._v(t._s(e.levelEng+"/"+e.levelChn+"/"+e.grade))])])})),1),n("el-select",{attrs:{placeholder:"图纸表现"},model:{value:t.appearance,callback:function(e){t.appearance=e},expression:"appearance"}},t._l(t.grades,(function(e,o){return n("el-option",{key:o,attrs:{label:"图纸表现 | "+e.grade+"分",value:e.grade}},[n("span",[t._v(t._s(e.levelEng+"/"+e.levelChn+"/"+e.grade))])])})),1),n("el-select",{attrs:{placeholder:"创新性"},model:{value:t.innovation,callback:function(e){t.innovation=e},expression:"innovation"}},t._l(t.grades,(function(e,o){return n("el-option",{key:o,attrs:{label:"创新性 | "+e.grade+"分",value:e.grade}},[n("span",[t._v(t._s(e.levelEng+"/"+e.levelChn+"/"+e.grade))])])})),1),n("el-button",{attrs:{icon:"el-icon-edit",type:"primary"}},[t._v("评审意见")]),n("el-button",{attrs:{icon:"el-icon-search",type:"primary"}},[t._v("保存评审进度")])]:t._e(),n("el-button",{attrs:{type:"primary"},on:{click:t.nextHandler}},[t._v("下一个"),n("i",{staticClass:"el-icon-arrow-right"})])],2),t.contestConfig.enableMarking?[n("div",{staticStyle:{display:"flex","justify-content":"flex-end","margin-top":"20px"}},[n("div",{staticStyle:{height:"150px",width:"400px",border:"1px solid #E4E7ED","border-radius":"4px",display:"flex","flex-direction":"column","align-items":"center"}},[n("div",{staticStyle:{"font-family":"Noto Sans SC","font-style":"normal","font-weight":"normal","font-size":"14px","line-height":"22px","font-feature-settings":"'tnum' on, 'lnum' on",color:"#909399",margin:"10px 0"}},[t._v("评审意见填写栏")]),n("el-input",{staticStyle:{width:"370px"},attrs:{type:"textarea",rows:4,resize:"none"},model:{value:t.voteAdvise,callback:function(e){t.voteAdvise=e},expression:"voteAdvise"}})],1)])]:t._e()],2)},s=[],c=n("5530"),l=(n("caad"),n("2532"),n("159b"),n("a434"),n("4e82"),n("c740"),n("b0c0"),n("2f62")),d=n("f8c8"),u={name:"Detail",data:function(){return{total:0,targetWorkIdx:null,activeName:"first",workInfo:{},grades:[{levelEng:"A",levelChn:"第一档",grade:95},{levelEng:"B",levelChn:"第二档",grade:85},{levelEng:"C",levelChn:"第三档",grade:75},{levelEng:"D",levelChn:"第四档",grade:65}],design:"",appearance:"",innovation:"",voteAdvise:""}},mounted:function(){this.getData(),this.contestConfig.enableMarking?document.querySelector("#workContainer").style.height="calc(100% - 420px)":document.querySelector("#workContainer").style.height="calc(100% - 172px)"},computed:Object(c["a"])({},Object(l["b"])(["userInfo","voteInfo","votedWorks","contestConfig"])),watch:{$route:function(t){this.workInfo.workID=~~t.params.workID,this.workInfo.checked=this.votedWorks.includes(this.workInfo.workID),this.getData()}},methods:Object(c["a"])(Object(c["a"])({},Object(l["c"])(["updateVoteInfo","updateVotedWorks"])),{},{workBoxClickHandler:function(t){t.checked=!t.checked;var e=this.voteInfo;t.checked?(e.push(t),this.updateVoteInfo(e)):e.forEach((function(n,o){n.workID===t.workID&&e.splice(o,1)}))},toTargetWork:function(){var t=this,e={workIdx:this.targetWorkIdx>0&&this.targetWorkIdx<this.contestConfig.totalWorkNum?this.targetWorkIdx:this.$message({type:"warning",message:"序号错误！"}),round_idx:this.contestConfig.roundIdx};Object(d["g"])(e).then((function(e){var n=e.data;t.$router.push({path:"/detail/"+n}),t.getData()}))},prevHandler:function(){var t=this,e={workIdx:this.workInfo.workIdx>1?this.workInfo.workIdx-1:this.contestConfig.totalWorkNum};Object(d["g"])(e).then((function(e){var n=e.data;t.$router.push({path:"/detail/"+n}),t.getData()}))},nextHandler:function(){var t=this,e={workIdx:this.workInfo.workIdx<this.contestConfig.totalWorkNum?this.workInfo.workIdx+1:0};Object(d["g"])(e).then((function(e){var n=e.data;t.$router.push({path:"/detail/"+n}),t.getData()}))},checkChangeHandler:function(t){var e=this;if(this.userInfo.isDone)this.$message({type:"warning",message:"已经提交过了，不能再更改了！"});else if(this.votedWorks.length===this.contestConfig.maxVotesNum&&t)this.$message({type:"warning",message:"不能再选了！"});else{var n=this.voteInfo,o=this.votedWorks;t?(n.push(this.workInfo),n.sort((function(t,e){return t.workID-e.workID})),o.push(this.workInfo.workID),o.sort((function(t,e){return t-e}))):(n.splice(n.findIndex((function(t){return t.workID===e.workInfo.workID})),1),o.splice(o.indexOf(this.workInfo.workID),1)),this.updateVotedWorks(o),this.updateVoteInfo(n)}},getData:function(){var t=this,e={work_id:~~this.$route.params.workID,round_idx:this.contestConfig.roundIdx};Object(d["h"])(e).then((function(e){var n,o=e.data;""===o.name&&(o.name="测试"),(null===(n=!o.imgList)||void 0===n||n)&&(o.imgList=["https://ivillages-images.oss-cn-qingdao.aliyuncs.com/1/static/imgs/test.png"]),o.checked=!1,t.workInfo=o,t.workInfo.checked=t.votedWorks.includes(t.workInfo.workID)}))},returnToOverview:function(){this.$router.push({path:"/overview"})}})},f=u,h=(n("7c71"),n("2877")),p=Object(h["a"])(f,a,s,!1,null,"624cc6bb",null),v=p.exports,g={name:"Detail",components:{Selected:r["a"],DetailComp:v}},k=g,m=Object(h["a"])(k,o,i,!1,null,"604882c6",null);e["default"]=m.exports},a15b:function(t,e,n){"use strict";var o=n("23e7"),i=n("44ad"),r=n("fc6a"),a=n("a640"),s=[].join,c=i!=Object,l=a("join",",");o({target:"Array",proto:!0,forced:c||!l},{join:function(t){return s.call(r(this),void 0===t?",":t)}})},a434:function(t,e,n){"use strict";var o=n("23e7"),i=n("23cb"),r=n("a691"),a=n("50c4"),s=n("7b0b"),c=n("65f0"),l=n("8418"),d=n("1dde"),u=d("splice"),f=Math.max,h=Math.min,p=9007199254740991,v="Maximum allowed length exceeded";o({target:"Array",proto:!0,forced:!u},{splice:function(t,e){var n,o,d,u,g,k,m=s(this),x=a(m.length),w=i(t,x),y=arguments.length;if(0===y?n=o=0:1===y?(n=0,o=x-w):(n=y-2,o=h(f(r(e),0),x-w)),x+n-o>p)throw TypeError(v);for(d=c(m,o),u=0;u<o;u++)g=w+u,g in m&&l(d,u,m[g]);if(d.length=o,n<o){for(u=w;u<x-o;u++)g=u+o,k=u+n,g in m?m[k]=m[g]:delete m[k];for(u=x;u>x-o+n;u--)delete m[u-1]}else if(n>o)for(u=x-o;u>w;u--)g=u+o-1,k=u+n-1,g in m?m[k]=m[g]:delete m[k];for(u=0;u<n;u++)m[u+w]=arguments[u+2];return m.length=x-o+n,d}})},ab13:function(t,e,n){var o=n("b622"),i=o("match");t.exports=function(t){var e=/./;try{"/./"[t](e)}catch(n){try{return e[i]=!1,"/./"[t](e)}catch(o){}}return!1}},addb:function(t,e){var n=Math.floor,o=function(t,e){var a=t.length,s=n(a/2);return a<8?i(t,e):r(o(t.slice(0,s),e),o(t.slice(s),e),e)},i=function(t,e){var n,o,i=t.length,r=1;while(r<i){o=r,n=t[r];while(o&&e(t[o-1],n)>0)t[o]=t[--o];o!==r++&&(t[o]=n)}return t},r=function(t,e,n){var o=t.length,i=e.length,r=0,a=0,s=[];while(r<o||a<i)r<o&&a<i?s.push(n(t[r],e[a])<=0?t[r++]:e[a++]):s.push(r<o?t[r++]:e[a++]);return s};t.exports=o},c62a:function(t,e,n){},c740:function(t,e,n){"use strict";var o=n("23e7"),i=n("b727").findIndex,r=n("44d2"),a="findIndex",s=!0;a in[]&&Array(1)[a]((function(){s=!1})),o({target:"Array",proto:!0,forced:s},{findIndex:function(t){return i(this,t,arguments.length>1?arguments[1]:void 0)}}),r(a)},caad:function(t,e,n){"use strict";var o=n("23e7"),i=n("4d64").includes,r=n("44d2");o({target:"Array",proto:!0},{includes:function(t){return i(this,t,arguments.length>1?arguments[1]:void 0)}}),r("includes")},d998:function(t,e,n){var o=n("342f");t.exports=/MSIE|Trident/.test(o)},f7e3:function(t,e,n){}}]);
//# sourceMappingURL=chunk-faf0ccd0.32187de3.js.map